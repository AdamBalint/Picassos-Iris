# UI for Picasso's Iris

This directory contains the src files Picasso's Iris UI.

## Table of contents

- [How it works](#how-it-works)
  - [Backend](#backend)
  - [Frontend](#frontend)
- [Technologies used](#technologies-used)
- [Development](#development)
  - [File structure](#file-structure)
  - [Setting up a local environment from fresh](#setting-up-a-local-environment-for-ui-development-from-fresh)

## How it works

<p align="center">
  <img alt="Big picture diagram of Iris GUI" src="http://i.imgur.com/BZ8HA8Q.png" />
  <b><i>Big picture overview of Iris GUI</i></b>
</p>

The UI primarily has 2 levels, **the backend** and **the frontend**.

### Backend
- Initially starts the server, and opens the WebView window
- Initially renders the page, `index.html`
- Contains various routes for handling different actions to communicate back to the frontend when requested

### Frontend
- Represents GUI app to be presented to the user.
- Built with HTML, CSS and JavaScript (Single-Page-Application)
- Communicates via HTTP (AJAX) requests to the backend server
- In terms of how the application is bundled and loaded:
    1. Webpack bundles all the assets (The React components, the images into a single `bundle.js` file, and the stylesheets (.css, .scss) into a single `style.css`)
    2. When the `index.html` is loaded, it loads the `bundle.js` file which then loads the app.

## Technologies used

We use a variety of open-source technologies, **all credits and thanks to original creators**.

- Backend
  - [Flask for Python HTTP server](http://flask.pocoo.org/)
  - [PyWebView for a lightweight WebView library for Linux, Mac, Windows](https://github.com/r0x0r/pywebview/)
    - **Important**, we use a fork (file-filter branch) of the PyWebView library to suit our needs, it can be found [here](https://github.com/fzxt/pywebview/tree/file-filter)

- Frontend
  - [NodeJS & NPM (Node package manager) for dependency management](https://www.npmjs.com/)
  - [React as a frontend library to build an SPA](https://facebook.github.io/react/)
  - [Webpack 2 for bundling app/modules](https://webpack.github.io/)
  - [SCSS/Sass, for CSS with superpowers](http://sass-lang.com/)

- Deployment
  - [py2app for deployment on OSX](https://pythonhosted.org/py2app/)
  - [py2exe for deployment on Windows](http://www.py2exe.org/)


## Development

### File structure

```
.
├── backend -- Contains main.py, entrypoint of app
│   └── webview -- Personal fork of WebView library
├── build -- Folder generated by py2exe/py2app
├── dist -- Folder generated by py2exe/py2app
├── frontend
│   ├── app -- Bulk of Single Page App
│   │   ├── components -- React component classes
│   │   │   ├── home -- Specific component, contains .js component class and .scss for styling
│   │   │   └── nav
│   │   └── util -- Utility modules used by components, such as Ajax module
│   ├── assets -- Static assets such as fonts, images and external css libraries go here
│   ├── dist -- Folder generated by webpack, includes bundle.js and style.css
│   ├── global_styles -- Global styles include Sass rules used throughout the app.
│   ├── index.html -- HTML file that is served by the Backend when WebView is initially opened
│   └── package.json -- Node.js package.json file for installing dependencies
├── icon.icns -- Icon for OSX
└── icon.ico -- Icon for Windows
```

### Requirements

- Node.js V6.0+ (Developed on Node 6.8.0)
- Python 3.5


### NPM build and development scripts

Currently, we have two tasks for bundling and development:

`npm run build` -- For simply bundling with Webpack, generates a bundle.js and style.css in the frontend/dist folder.

`npm run build:watch` -- Tells webpack to watch for changes, any code changes in the frontend directory will cause Webpack to generate a dist folder.

You can find all scripts mentioned in the `package.json` file.

### Setting up a local environment for UI development from fresh

In a terminal window, fire the following commands

```sh
git clone https://github.com/Adam-Balint/Picassos-Iris
cd Picassos-Iris/
pip3 install -r requirements.txt
cd src/UI/frontend
npm install
npm run build:watch
```

Webpack will now watch the frontend directory for any changes during development
and generate the bundled application in `frontend/dist`.

**You'll want to leave this window open, as you are developing**

In a seperate terminal window.

```
cd Picassos-Iris/src/UI/backend
python3 main.py
```

You should see a WebView window pop up.

To quit the python process, simply close the WebView window.

#### Tips!
For debugging and general development of the GUI, we don't recommend you play around with the actual WebView window when developing.

Instead, start up the server, your favorite browser and navigate to [http://127.0.0.1:23948](http://127.0.0.1:23948) and develop/see changes from there.
